<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	 
<mapper namespace="studyManagementMapper"> 
	
	<select id="selectStudyNoticeList" resultType="com.studyManagement.VO.studyManagementInfoVO" >
		<![CDATA[
			SELECT	*
			  FROM	(
						SELECT	ROWNUM	as RNUM
							 ,	main.*	
						  FROM	(
									SELECT	/*+ ordered use_nl(us) INDEX_DESC(us USERINSTUDY_IDX) */
										(	SELECT 	si.STUDY_NAME
											FROM	STUDY_INFO si
											WHERE	si.STUDY_CODE	=	us.STUDY_CODE)		as	studyName
										,	(	SELECT	ui.USER_ID
												FROM 	USER_INFO ui
												WHERE	ui.USER_CODE	=	us.USER_CODE)	as 	studyMemberName
										,	us.USER_POSITION								as	studyMemberPosition
									FROM	USER_IN_STUDY us
									WHERE	us.USE_YN			=	'Y'
										AND	us.STUDY_CODE 	IN	(SELECT us2.STUDY_CODE
																 FROM	USER_IN_STUDY us2
																 WHERE	us2.STUDY_CODE	=	#{studyCode}
																 	AND	us2.USE_YN		=	'Y'
																 )
								) main 
						  WHERE ROWNUM <= #{last}
					)
			WHERE	RNUM >= #{first}
		]]>
	</select>
	
	<select id="selectStudyNoticeListToCnt" resultType="int">
		<![CDATA[
			SELECT	COUNT(*)
			FROM	USER_IN_STUDY
			WHERE	USER_IN_STUDY.USE_YN		=	'Y'
				AND	USER_IN_STUDY.STUDY_CODE	=	#{studyCode}
		]]>
	</select>
</mapper>